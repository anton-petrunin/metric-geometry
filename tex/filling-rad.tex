\chapter{Volume bounds filling radius}

This chapter 
is devoted to a proof of \ref{thm:FillRad<vol};
that is, we will show that \emph{Riemannian manifolds with small volume have small filling radius}.
Note that once it is proved, \ref{thm:sys<FillRad} implies \ref{thm:sys(torus)}.
Moreover \ref{thm:sys<FillRad++} implies the following:

\begin{thm}{Therorem}\label{thm:sys(torus)+}
A systolic intequality holds for any essential manifold. 
\end{thm}

Theorem \ref{thm:FillRad<vol} was proved originally by Mikhael Gromov \cite{gromov-1983}.
The technique for all known proofs have origin in the theory of minimal surfaces.

We follow closely a simplified proof given by Alexander Nabutovsky; some of the moves in this proof were suggested by Roman Karasev \cite{nabutovsky}.
This simplification is based on proofs given by Larry Guth \cite{guth} and  Panos Papasoglu \cite{papasoglu}.



\section{Nerves and partition of unity}

Let $\{V_1,\dots,V_k\}$ be a finite open cover of a compact metric space $\spc{X}$.
Consider an abstract simplicial complex $\spc{N}$, with one vertex $v_i$ for each set $V_i$ such that a simplex with vertexes $v_{i_1},\dots, v_{i_m}$ is included in $\spc{N}$ if 
the intersection $V_{i_1}\cap\dots\cap V_{i_m}$ is nonempty.
The obtained simplicial complex $\spc{N}$ called the \index{nerve}\emph{nerve of the covering $\{V_i\}$}.

Note that $\spc{N}$ is a finite simplicial complex;
it is a subcomplex of a simplex with the vertixes $\{v_1,\dots,v_k\}$.
The nerve $\spc{N}$ has dimension at most $n$ if and only if the covering $\{V_1,\dots,V_k\}$ has multiplicity is at most $n+1$;
that is, any point $x\in\spc{X}$ belongs to
at most $n+1$ sets of the covering.

\begin{thm}{Proposition}\label{thm:part-unit}
 Let $\{V_1,\dots,V_k\}$ be a finite open covering of a compact metric space ${\spc{X}}$.
Then there are Lipschitz functions $\psi_i\:{\spc{X}}\z\to[0,1]$ such that
if $\psi_i(x)>0$ then $x\in V_i$ and
$$\sum_i\psi_i(x)=1$$
for any $x\in {\spc{X}}$.
\end{thm}

\parit{Proof.}
Consider functions $\phi_i\:{\spc{X}}\to\RR$ defined as
$$\phi_i(x)=\distfun_{({\spc{X}}\backslash V_i)} x.$$
Note $\phi_i$ is $1$-Lipschitz
for any $i$
and $\phi_i(x)>0$ if and only if $x\in V_i$.
Since $\{V_i\}$ is a covering, we have that
$$\sum_i\phi_i(x)>0\ \ \text{for any}\ \ x\in {\spc{X}}.$$

Set 
$$\psi_k(x)=\frac{\phi_k(x)}{\sum_i\phi_i(x)}.$$
Observe that by construction the functions $\psi_i$ meet the conditions in the proposition.
\qedsf

A collection of functions $\{\psi_i\}$ that meets the conditions in \ref{thm:part-unit} is called 
a \emph{partition of unity subordinate to the open covering}\index{partition of unity} $\{V_1,\dots,V_k\}$.

Suppose $\{\psi_i\}$ is  
a partition of unity subordinate to the open covering $\{V_1,\dots,V_k\}$.
Note that for any point $x\in {\spc{X}}$, the set
$$\set{v_i}{\psi_i(x)>0}$$
describe vertexes of a simplex in the nerve.
Therefore 
$$\psi\:x\mapsto \psi_1(x)\cdot v_1+\psi_2(x)\cdot v_2+\dots+\psi_k(x)\cdot v_n.$$
describes a Lipschitz map from ${\spc{X}}$ to the nerve $\spc{N}$ of $\{V_i\}$;
here the point $x$ is mapped to the point with barycentric coordinates $\psi_i(x)$.
In other words we proved the following:

\begin{thm}{Proposition}\label{prop:space->nerve}
Let $\spc{N}$ be a nerve of an open covering $\{V_1,\z\dots,V_k\}$ of a compact metric space $\spc{X}$.
Denote by $v_i$ the vertex of $\spc{N}$ that corresponds to $V_i$.

Then there is a Lipschitz map $\psi\:\spc{X}\to\spc{N}$ such that $\psi(V_i)\z\subset\Star_{v_i}$ for every $i$;
that is, for any $x\in V_i$ the point $\psi(x)$ lies the interior of some simplex with vertex $v_i$.
\end{thm}


\section{Width}

Suppose $A$ is a subset of a metric space $\spc{X}$.
The radius of $A$ (briefly $\rad A$) is defined as the least upper bound on the values $R>0$ such that $\oBall(x,R)\supset A$ for some $x\in \spc{X}$.

\begin{thm}{Definition}\label{def:width}
Let $\spc{X}$ be a metric space.
The $n$-th width of $\spc{X}$ (briefly $\width_n\spc{X}$) is defined as the least upper bound on values $R>0$ such that $\spc{X}$ admits a finite open covering $\{V_i\}$ with multiplicity at most $n+1$ and $\rad V_i< R$ for each $i$.
\end{thm}

\parit{Remarks.}
\begin{itemize}
\item Observe that 
\[\width_0\spc{X}\ge\width_1\spc{X}\ge\dots\]
for any compact matric space $\spc{X}$.
Moreover, if $\spc{X}$ is connected, then 
\[\width_0\spc{X}=\rad\spc{X}.\]
\item 
Usually width is defined using diameter instead of radius, but the result differ at most twice.
Namely if $r$ is the radius-width and $d$ --- diameter-width for the same $n$, then 
$r\le d\le 2\cdot r$.

\item Note that \emph{Lebesgue covering dimension} of $\spc{X}$ can be defined as the least number $n$ such that $\width_n\spc{X}=0$.
Another closely related notion is the so called \emph{macroscopic dimesion on scale $R$};
it is defined as the  least number $n$ such that $\width_n\spc{X}<R$.
\end{itemize}

\begin{thm}{Exercise}\label{ex:macrodimension}
Suppose $\spc{X}$ is a compact metric space such that any closed curve $\gamma$ in $\spc{X}$ can be contracted in its $R$-neighborhood.
Show that $\spc{X}$ has macroscopic dimension at most 1 on scale $100\cdot R$.

What about quasiconverse? That is, suppose a simply connected compact metric space $\spc{X}$ has macroscopic dimension at most 1 on scale $R$, is it true that any closed curve $\gamma$ in $\spc{X}$ can be contracted in its $100\cdot R$-neighborhood?
\end{thm}


The following proposition provides an equivalent definition;
we will not use it, but it provides a good reason for the name \emph{width}.

\begin{thm}{Proposition}\label{prop:width=suprad(inv)}
Suppose $\spc{X}$ is a compact metric space.
Then $\width_n\spc{X}<R$ if and only if there is a finite $n$-dimensional simplicial complex $\spc{N}$ and a continuous map $\psi\:\spc{X}\to \spc{N}$
such that $\rad[\psi^{-1}(s)]\z<R$
for any $s\in \spc{N}$.
\end{thm}

\parit{Proof; ``only if'' part.}
Suppose $\width_n\spc{X}<R$.
Consider a covering $\{V_1,\dots,V_k\}$ of $\spc{X}$ guaranteed by the definition of width.
Let $\spc{N}$ be its nerve and $\psi\:\spc{X}\to \spc{N}$ be the map provided by \ref{prop:space->nerve}.

Since the multiplicity of the covering is at most $n+1$, we ahve $\dim \spc{N}\le n$.

Note that if $x\in \spc{N}$ lies in a star of a vertex $v_i$,
then $\psi^{-1}\{x\}\z\subset V_i$;
in particular $\rad[\psi^{-1}\{x\}]<R$.

\parit{``If'' part.}
Choose $x\in \spc{N}$.
Since the inverse image $\psi^{-1}\{x\}$ is compact, $\psi$ is continuous, and $\rad[\psi^{-1}\{x\}]<R$,
there is a neighborhood $U\ni x$ such that the  $\rad[\psi^{-1}(U)]<R$.

Since $\spc{X}$ is compact,  there is a finite cover $\{U_i\}$ of $\spc{N}$ such that $\psi^{-1}(U_i)\subset\spc{X}$ has radius smaller than $R$ for each $i$.
Since $\spc{N}$ has dimension $n$, we can inscribe%
\footnote{Recall that a covering $\{W_i\}$ is inscribed in the covering $\{U_i\}$ if for every $W_i$ is a subset of some $U_j$.} 
in $\{U_i\}$ a finite open cover $\{W_i\}$ with multiplicity at most $n+1$.
It remains to observe that $V_i=\psi^{-1}(W_i)$ defines a finite open cover of $\spc{X}$ with radius less than $R$ and multiplicity at most $n+1$. 
\qeds

\section{Riemannian polyhedrons}

A \emph{Riemannian polyhedron} is defined as a finite simplicial complex with a metric tensor on each simplex such that the restriction of the metric on each simplex to a subsymplex coinsides with the metric on the subsmplex.
The dimension of Riemannian polyhedron is defined as the largest dimension it its triangulation.
For Riemannian polhedron one can define length of curves and volume the same way as for Riemannian manifolds.


Further we will apply the notion of width to compact Riemannian polyhedrons.
If $\spc{P}$ is an $n$-dimensional compact Riemannian polyhedron, then 
we suppose that
\[\width\spc{P}\df\width_{n-1}\spc{P}.\]

\begin{thm}{Exercise}\label{ex:FillRad<width}
Show that for any closed Riemannian manifold $\spc{M}$ we have
\[\FillRad \spc{M}\le 100\cdot \width\spc{M};\]
try to show that in fact
\[\FillRad \spc{M}\le \width\spc{M}.\]

\end{thm}

\section{Volume profile bounds width}

Let $\spc{P}$ be an $n$-dimensional Riemnnian polyhedron.
Let us define \emph{volume profile} of $\spc{P}$ as a function 
returning volume of largest $r$-ball in $\spc{P}$;
that is, $\VolPro_{\spc{P}}\:\RR_+\to\RR_+$ is defined by 
\[\VolPro_{\spc{P}}(r)\df \sup\set{\vol_n \oBall(p,r)}{p\in\spc{P}}.\]
Note that $\VolPro_{\spc{P}}$ is a nondecreasing function and $\VolPro_{\spc{P}}(r)\z\to\vol_n\spc{P}$ as $r\to\infty$.

\begin{thm}{Theorem}\label{thm:width<volpro}
There is a constant $c_n>0$ such that if for some $R>0$
the inequality 
\[R> c_n\cdot \sqrt[n]{\VolPro_{\spc{P}}(R)}\]
holds for an $n$-dimensional Reimannian polyhedron
$\spc{P}$, then 
\[\width\spc{P}\le  R.\]
\end{thm}

Since $\VolPro_{\spc{P}}(r)\le \vol\spc{P}$ for any $r$,
we get the following:

\begin{thm}{Corollary}\label{thm:width<vol}
There is a constant $c_n>0$ such that 
\[\width\spc{P}\le c_n\cdot \sqrt[n]{\vol\spc{P}}\] 
for any  $n$-dimensional Reimannian polyhedron $\spc{P}$.
\end{thm}

Together with \ref{ex:FillRad<width}, the last theorem implies \ref{thm:FillRad<vol}, which is the goal of this lecture.

\section*{Proof}

In the proof of \ref{thm:width<volpro}, we will use the following three technical statements,
the proofs are omitted, but they are not hard. 

\begin{thm}{Smoothing procedure}
Let $\spc{P}$ be a Reimannian polyhedron and $f\:\spc{P}\to \RR$ be a 1-Lipschitz function.
Then for any $\delta>0$ there is a  1-Lipschitz function $\tilde f\:\spc{P}\to \RR$ that is smooth on each simplex of the triangulation and $\delta$-close to $f$.
\end{thm}

\begin{thm}{Sard's theorem}
Let $\spc{P}$ be an $n$-dimensional Reimannian polyhedron and $f\:\spc{P}\to \RR$ be a function that is smooth on each simplex.
Then for almost all values $a$, each component of the inverse image $f^{-1}\{a\}$ equipped with the induced metric is a Reimannian polyhedron.
\end{thm}


\begin{thm}{Coarea inequality}
Let $\spc{P}$ be an $n$-dimensional Reimannian polyhedron and $f\:\spc{P}\to \RR$ be a 1-Lipschitz function that is smooth on each simplex.
Then 
\[\vol_n (f^{-1}[a,b]) \le \int_a^b\vol_{n-1}(f^{-1}\{x\})\cdot dx.\]
\end{thm}

Theorem \ref{thm:width<volpro} will be proved by induction on the dimension of $\spc{P}$;
the following exercise provides a base for the induction.
Note that if a 1-dimensional Riemannian polyhedron $\spc{P}$ is connected, then 
\[\width\spc{P}=\width_0\spc{P}=\rad\spc{P}.\]

\begin{thm}{Exercise}\label{ex:1D-case}
Suppose $\spc{P}$ be a 1-dimensional Riemannian polyhedron.
Suppose $\VolPro_{\spc{P}}(r)<r$ for some $r>0$.
Show that 
\[\width \spc{P}<r.\]
%Try to find the optimal constant $c$ such that 
%\[\width \spc{P}<c\cdot r.\]???
\end{thm}


An $(n-1)$-dimensional subpolyhedron $\spc{Q}\subset\spc{P}$ is called \emph{$R$-separating} if $\rad U<R$ for each connected component $U$ of the complement $\spc{P}\backslash \spc{Q}$.

\begin{thm}{Lemma}\label{lem:separating}
Let $\spc{P}$ be an $n$-dimensional Riemannian polyhedron.
Then given $R>0$ and $\eps>0$ there is a $R$-separating subpolyhedron $\spc{Q}\subset\spc{P}$ such that for any $r_0<r_1\le R$ we have
\[\VolPro_{\spc{Q}}(r_0)< \tfrac1{r_1-r_0}\cdot \VolPro_{\spc{P}}(r_1)+\eps.\]

\end{thm}

\parit{Proof.}
Choose a small $\delta>0$.
Applying the smoothing procedure, we can exchange each distance function $\distfun_p$ on $\spc{P}$ by $\delta$-close smooth 1-Lipschitz function, which will be denoted by $\widetilde \distfun_p$.

By Sard's theorem, almost all level sets $\tilde S_c(p)$ defined by $\widetilde \distfun_p=c$ are smooth Riemannian polyhedrons of dimension $n-1$.

Since $\delta$ is small, the coarea inequality implies that 
for some  $c\z\in(r_0+\delta, r_1-\delta)$ we have
\begin{align*}
\vol_{n-1}\tilde S_c(p)&\le \tfrac1{r_1-r_0-2\cdot\delta}\cdot\vol_n[\oBall(p,r_1)]<
\\
&<\tfrac1{r_1-r_0}\cdot \VolPro_{\spc{P}}(r_1)+\tfrac\eps2.
\end{align*}

Suppose $\spc{Q}$ is an $R$-separating subpolyhedron in $\spc{P}$ with almost minimal volume, say its volume is at most $\tfrac\eps2$-far from the greatest lower bound.
Note that cutting from $\spc{Q}$ everything inside $\tilde S_c$ and adding $\tilde S_c$ keeps it to be $R$-separating subpolyhedron.
Since $\spc{Q}$ has almost minimal volume, we have
\[\vol_{n-1}[\spc{Q}\cap \oBall(p,r_0)_{\spc{P}}]-\tfrac\eps2\le \vol_{n-1}S_c.\]
Therefore 
\[\vol_{n-1}[\spc{Q}\cap \oBall(p,r_0)_{\spc{P}}]\le\tfrac1{r_1-r_0}\cdot \VolPro_{\spc{P}}(r_1)+\eps\eqlbl{eq:volQ<ProP}\]
Recall that $\spc{Q}$ is equipped with the induced length metric;
therefore $\dist{p}{q}{\spc{Q}}\ge \dist{p}{q}{\spc{P}}$ for any $p,q\in \spc{Q}$;
in particular, 
\[\oBall(p,r_0)_{\spc{Q}}\subset \spc{Q}\cap \oBall(p,r_0)_{\spc{P}}\]
for any $p\in \spc{Q}$ and $r\ge 0$.
Hence \ref{eq:volQ<ProP} implies the lemma.
\qeds

\begin{thm}{Lemma}\label{lem:separating-width}
Let $\spc{Q}$ be a $R$-separating subpolyhedron in an $n$-dimensional Riemannian polyhedron $\spc{P}$.
Suppose $\width\spc{Q}\le R$.
Then $\width\spc{P}\le R$
\end{thm}

\parit{Proof.}
Start with an open covering $\{V_1,\dots,V_k\}$ of $\spc{Q}$ of multiplicity $\le n$ with radiuses of the sets in the intrinsic metric $\le R$.

Note that $\{V_1,\dots,V_k\}$ can be converted into an an open covering of
a small neighbourhood of $\spc{Q}$ in $\spc{P}$ without increasing the multiplicity.
This is can be done by setting 
\[V_i'=\bigcup_{x\in V_i}\oBall(x,r_x),\]
where $r_x=\tfrac1{10}\cdot\inf\set{\dist{x}{y}{}}{y\in \spc{Q}\backslash V_i}$.

Adding to  $\{V_i'\}$ all the components of $\spc{P}\backslash \spc{Q}$,
we increase the multiplicity by at most 1 and obtain a covering of $\spc{P}$.
The statement follows since $\dim \spc{P}= \dim \spc{Q}\z+1$.
\qeds

\parit{Proof of \ref{thm:width<volpro}.}
We apply induction on the dimension $n=\dim\spc{P}$ to show that one can take $c_n=n$.%
\footnote{In \cite{nabutovsky} the calculations were optimized little better which gave the constants 
\[c_n=\sqrt[n]{n!}= \tfrac ne+o(n).\]}
The base case $n=1$ is given in \ref{ex:1D-case}.

Suppose that the  $(n-1)$-dimensional case is proved.
Consider an $n$-dimensional Riemannian polyhedron $\spc{P}$ and suppose
\[n\cdot \sqrt[n]{\VolPro\spc{P}(R)}< R\]
for some $R>0$.
Fix small $\eps>0$.
Let $\spc{Q}$ be an $R$-separating subpolyhedron in $\spc{P}$ provided by \ref{lem:separating}.
Applying  \ref{lem:separating} for $r=\tfrac{n-1}n\cdot R$ and $R$, we have that 
\begin{align*}
\VolPro_\spc{Q}(r) &< \tfrac nr\cdot \VolPro_\spc{P}(R)+\eps<
\\
&<\frac {n}{R}\cdot\left(\frac{R}{n}\right)^n=
\\
&=\left(\frac{r}{n-1}\right)^{n-1};
\end{align*}
that is, $(n-1)\cdot \sqrt[n-1]{\VolPro\spc{Q}(r)}< r$.
By the induction hypothesis, $c_{n-1}\z=n-1$;
since $\dim\spc{Q}=n-1$ we get that
\[\width\spc{Q}\le r<R.\]
It remains to apply \ref{lem:separating-width}.
\qeds

\section{Remarks}

%The notion of nerve was introduced by Pavel Alexandrov \cite{alexandrov-1928}.



In the end of \cite{nabutovsky} you can find a direct proof of the inequality 
\[\sys \spc{M}\le 4\cdot \width\spc{M}\]
for essential manifold $\spc{M}$.
The proof was suggested by Roman Karasev;
it makes possible to prove a systolic inequality without using filling radius.
