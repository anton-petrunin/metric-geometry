\parbf{\ref{ex:conv-short};} \textit{only-if part}.
To check convexity, assume that $B$ is a two-point subset.
For closeness, assume that $B$ is a countable set of $A$.

\parit{If part.}
Learn about the Kirszbraun theorem and apply it together with the closest-point projection.

\refstepcounter{chapter}
\setcounter{eqtn}{0}


\parbf{\ref{ex:inj=complete-geodesic-contractible}.}
Choose an injective space $\spc{Y}$.

\textit{\ref{SHORT.ex:inj=complete-geodesic-contractible:complete}.}
Fix a Cauchy sequence $x_n$ in $\spc{Y}$;
we need to show that it has a limit $x_\infty\in \spc{Y}$.
Consider metric on $\spc{X}=\NN\cup\{\infty\}$ defined by 
\begin{align*}
\dist{m}{n}{\spc{X}}&\df\dist{x_m}{x_n}{\spc{Y}},
\\
\dist{m}{\infty}{\spc{X}}&\df\lim_{n\to\infty}\dist{x_m}{x_n}{\spc{Y}}.
\end{align*}
Since the sequence is Cauchy, so is the sequence $\ell_n=\dist{x_m}{x_n}{\spc{Y}}$ for any $m$.
Therefore, the last limit is defined.

By construction, the map $n\mapsto x_n$ is distance-preserving on $\NN\subset \spc{X}$.
Since $\spc{Y}$ is injective, this map can be extended to $\infty$ as a short map; set $\infty\mapsto x_\infty$.
Since $\dist{x_n}{x_\infty}{\spc{Y}}\le \dist{n}{\infty}{\spc{X}}$ 
and $\dist{n}{\infty}{\spc{X}}\to 0$, we get that
$x_n\to x_\infty$ as $n\to\infty$.

\textit{\ref{SHORT.ex:inj=complete-geodesic-contractible:geodesic}.}
Applying the definition of injective space, we get a midpoint for any pair of points in $\spc{Y}$.
By \ref{SHORT.ex:inj=complete-geodesic-contractible:complete},
$\spc{Y}$ is a complete space.
It remains to apply \ref{lem:mid>geod:geod}.

\textit{\ref{SHORT.ex:inj=complete-geodesic-contractible:contractible}.}
Let $k\:\spc{Y}\hookrightarrow \ell^\infty(\spc{Y})$ be the Kuratowski embedding (\ref{lem:kuratowski}).
Observe that $\ell^\infty(\spc{Y})$ is contractible;
in particular, there is a homotopy $k_t\:\spc{Y}\hookrightarrow \ell^\infty(\spc{Y})$ such that $k_0=k$ and $k_1$ is a constant map.
(In fact, one can take $k_t=(1-t)\cdot k$.)

Since $k$ is distance-preserving and $\spc{Y}$ is injective,
there is a short map $f\:\ell^\infty(\spc{Y})\to \spc{Y}$ such that the composition $f\circ k$ is the identity map on $\spc{Y}$.
The composition $f\circ k_t\:\spc{Y}\hookrightarrow \spc{Y}$ provides the needed homotopy. 

\parbf{\ref{ex:bicombing}.}
By \ref{lem:kuratowski}, the space $\spc{Y}$ can be considered as a subset in $\ell^\infty(\spc{Y})$.
Given $x,y\in \spc{Y}$, let $\tilde\gamma_{x,y}(t)=(1-t)\cdot x+t\cdot y\in \ell^\infty(\spc{Y})$.
Observe that $\tilde\gamma_{x,y}$ meets all the conditions.
Apply the definition of injective space to $\ell^\infty(\spc{Y})$.

\parit{Source:} \cite[3.6]{lang-2013}.

\parbf{\ref{ex:injective-spaces}.}
Suppose that a short map $f\:A\to\spc{Y}$ is defined on a subset $A$ of a metric space $\spc{X}$.
We need to construct a short extension $F$ of $f$.
Without loss of generality, we may assume that $A\ne\emptyset$;
otherwise, map the whole $\spc{X}$ to a single point.
By Zorn's lemma, it is sufficient to enlarge $A$ by a single point $x\notin A$.

\parit{\ref{SHORT.ex:injective-spaces:R}.}
Suppose $\spc{Y}=\RR$.
Set 
\[F(x)=\inf\set{f(a)-\dist{a}{x}{}}{a\in A}.\] 
Observe that $F$ is short and $F(a)=f(a)$ for any $a\in A$.

\parit{\ref{SHORT.ex:injective-spaces:tree}.}
Suppose  $\spc{Y}$ is a complete metric tree.
Fix points $p\in \spc{X}$ and $q\in\spc{Y}$.
Given a point $a\in A$,
let $x_a\in\cBall[f(a),\dist{a}{p}{}]$ be the point closest to $f(x)$.
Note that $x_a\in[q\,f(a)]$ and either $x_a=q$ or $x_a$ lies on distance $\dist{a}{p}{}$ from $f(a)$.

Note that the geodesics $[q\,x_a]$ are nested;
that is, for any $a,b\in A$ we have either $[q\,x_a]\subset [q\,x_b]$ or $[q\,x_b]\subset [q\,x_a]$.
Moreover, in the first case, we have $\dist{x_b}{f(a)}{}\le \dist{p}{a}{}$ and in the second $\dist{x_a}{f(b)}{}\le \dist{p}{b}{}$.

It follows that the closure of the union of all geodesics $[q\,x_a]$ for $a\in\spc{A}$ is a geodesic.
Denote by $x$ its endpoint; it exists since $\spc{Y}$ is complete.
It remains to observe that $\dist{x}{f(a)}{}\le \dist{p}{a}{}$ for any $a\in\spc{A}$;
that is, one can take $f(p)=x$.

\parit{\ref{SHORT.ex:injective-spaces:ell-infty}.}
In this case, $\spc{Y}=(\RR^2,\ell^\infty)$.
Note that $\spc{X}\to (\RR^2,\ell^\infty)$ is a short map if and only if both of its coordinate projections are short.
It remains to apply \ref{SHORT.ex:injective-spaces:R}.

More generally, \textit{any $\ell^\infty$-product of injective spaces is injective};
in particular, if $\spc{Y}$ and $\spc{Z}$ are injective then the product $\spc{Y}\times\spc{Z}$ equipped with the metric 
\[\dist{(y,z)}{(y',z')}{\spc{Y}\times\spc{Z}}=\max\{\,\dist{y}{y'}{\spc{Y}},\dist{z}{z'}{\spc{Z}}\,\}\]
is injective as well.

\parbf{\ref{ex:extr-ball}}; \ref{SHORT.ex:extr-ball:one}.
Let $\spc{B}=\cBall[o,R]_{\spc{Y}}$.
Choose a metric space $\spc{X}$ with a subset $A$.
Given a short map $f\:A\to \spc{B}$ we need to find its short extension $\spc{X}\to \spc{B}$.

Since $\diam\spc{B}\le 2\cdot R$, we may assume that  $\diam \spc{X}\le 2\cdot R$;
if not pass to the metric defined by $\dist{x}{y}{}=\max\{\,\dist{x}{y}{\spc{X}},2\cdot R\,\}$.

Let us add point $w$ to $\spc{X}$ such that $\dist{w}{x}{}=R$ for any $x\in\spc{X}$;
denote the obtained space $\spc{X}'$.
Let $f'\:A\cup\{w\}\to \spc{B}$ be an extension of $f$ by $w\mapsto o$; note that $f'$ is short.

Since $\spc{Y}$ is injective, there is a short extension $F\:\spc{X}'\to \spc{Y}$ of $f'$.
Show and use that $F(\spc{X}')\subset \spc{B}$.

\parit{\ref{SHORT.ex:extr-ball:many}.}
Let $\spc{B}=\cap_\alpha\cBall[o_\alpha,R_\alpha]_{\spc{Y}}$.
Try to modify the argument in \ref{SHORT.ex:extr-ball:one}.

(Note that one may assume that $\diam \spc{X}\le 2\cdot \inf_\alpha\{\,R_\alpha\,\}$.
Consider the space $\spc{X}'=\spc{X}\cup\{w_\alpha\}$ such that $\dist{w_\alpha}{x}{}=R_\alpha$ for any $x\in \spc{X}$ and $\dist{w_\alpha}{w_\beta}{}=R_\alpha+R_\beta$ if $\alpha\ne\beta$.
Further, consider an extension of $f$ by $w_\alpha\mapsto o_\alpha$.)

\parbf{\ref{ex:extr-fixed}.}
Let $\diam \spc{Y}=2\cdot R$.
We can assume that $R>0$; otherwise there is nothing to prove.
Denote by $\spc{Z}$ a minimal (with respect to inclusion) intersection of closed $R$-balls in $\spc{Y}$ such that $s(\spc{Z})\subset\spc{Z}$.

Consider 
the intersection 
\[\spc{Y}'=\spc{Z}\cap\left(\bigcap_{p\in \spc{Z}} \cBall[p,R]_{\spc{Y}}\right).\]
By \ref{ex:extr-ball:many}, $\spc{Y}'$ is injective.
Use that $\spc{Z}$ is minimal to show that $s(\spc{Y}')\subset \spc{Y}'$.
Show that $\diam \spc{Y}'\le \tfrac12\cdot\diam \spc{Y}$.

Consider a sequence of nested injective spaces $\spc{Y}=\spc{Y}_0\supset \spc{Y}_1\supset\dots$ such that $\spc{Y}_{n+1}=\spc{Y}_{n}'$.
Choose a point $y_n\in \spc{Y}_{n}$ for each $n$.
Show that the sequence $y_n$ is Cauchy.
By \ref{ex:inj=complete-geodesic-contractible:complete}, $y_n$ converges, say to $y_\infty$.
Observe that $y_\infty$ is a fixed point of $s$.

\parbf{\ref{ex:circle};} \textit{only-if part}.
Suppose $r$ is extremal.
By \ref{lem:extremal-lipschitz}, $r$ is $1$-Lipschitz.
Since $\mathbb{S}^1$ is compact, \ref{lem:opposite-compact} implies that for any $p\in \mathbb{S}^1$ there is $q\in \mathbb{S}^1$ such that 
\[r(p)+r (q) = \dist{p}{q}{\mathbb{S}^1}.\]
Therefore
\begin{align*}
\pi&=\dist{p}{(-p)}{\mathbb{S}^1}\le 
\\
&\le 
r(p)+r(-p)=
\\
&=
r(p)+r(q) +r(-p) -r(q)\le
\\
&\le
\dist{p}{q}{\mathbb{S}^1}+\dist{q}{(-p)}{\mathbb{S}^1}=
\\
&=\pi.
\end{align*}
So, we have equality in both places, and the only-if part follows.

\parit{If part.}
Assume $r$ is a 1-Lipschitz function such that $r(p)+r(-p)=\pi$.
Then 
\begin{align*}
\dist pq{\mathbb{S}^1}&=
\dist{p}{(-p)}{\mathbb{S}^1}-\dist{q}{(-p)}{\mathbb{S}^1}\ge
\\
&\ge\pi -(r(-p)-r(q))=
\\
&=r(p)+r(q).
\end{align*}
Therefore $r$ is admissible.

Finally, if $r$ is not extremal, then there is an admissible function $s\le r$ such that $s(p)<r(p)$ for some $p$.
The latter contradicts the equality $r(p)+r(-p)=\pi$.

\parit{Source:} \cite[Proposition 2.7]{zuest}.

\parbf{\ref{ex:retraction}.}
Show and use that
$s^*(x)+s(y)\ge \dist{x}{y}{}$
for any $x,y\in \spc{X}$.

\parit{Remarks.}
It is easy to check that $q\:s\mapsto \tfrac12\cdot(s+s^*)$ is a short map on the space of admissible functions (with sup-norm).
Moreover, iterating $q$ and passing to the limit, we get a short retraction from the space of admissible functions to the space of extremal functions on $\spc{X}$ \cite[see 3.1 in][]{lang-2013}.
The existence of such a map will also follow from \ref{thm:inj-envelope}.

\parbf{\ref{ex:one-point-gluing}.}
Apply \ref{thm:injective=hyperconvex:balls}.

\parbf{\ref{ex:Rm-ell-infty}.}
Let $B=\cBall[0,1]$ and $P\supset B$ be a parallelepiped of minimal volume.
Choose the basis $e_1,\dots,e_m$ parallel to the edges of $P$ so that in the corresponding coordinates the parallelepiped is described by inequalities
$|x_i|\le 1$ for all $i$.

Let $B_i=\cBall[(1+R)\cdot e_i,R]$ for some $R>0$.
Show that $ e_i\in B$ for any $i$; in particular $B\cap B_i\ne\emptyset$.
Show $P$ can be chosen so that $B_i\cap B_j\ne \emptyset$ for all $i$ and~$j$ and all large $R>0$.
Apply hyperconvexity to show that $e_1+\dots+ e_m\in B$.
The same way, show that $\pm e_1\pm \dots\pm e_m\in B$ for all choices of signs.
Conclude that $B=P$.


\parbf{\ref{ex:urysohn-hyperconvex}.}
Denote by $\spc{U}_d$ the $d$-Urysohn space,
so $\spc{U}_\infty$ is the Urysohn space.

The extension property implies finite hyperconvexity.
It remains to show that $\spc{U}_d$ is not countably hyperconvex.

Suppose that $d<\infty$.
Then $\diam\spc{U}_d=d$ and for any point $x\in\spc{U}_d$ there is a point $y\in\spc{U}_d$ such that $\dist{x}{y}{\spc{U}_d}=d$.
It follows that there is no point $z\in\spc{U}_d$ such that $\dist{z}{x}{\spc{U}_d}\le \tfrac d2$ for any $x\in\spc{U}_d$.
Whence $\spc{U}_d$ is not countably hyperconvex.

Use \ref{ex:sphere-in-urysohn:midpoint} to reduce the case $d=\infty$ to the case $d<\infty$.


\parbf{\ref{ex:Inj(compact)}.}
Observe and use that the functions in $\Inj\spc{X}$ are 1-Lipschitz and uniformly bounded.

\parbf{\ref{ex:tripod+square}}; \ref{SHORT.ex:tripod+square:2}.
Use \ref{lem:opposite-compact} to show that if $f$ is extremal if and only if $f(v)=x$ and $f(w)=1-x$ for some $x\in [0,1]$.
Conclude that $\Inj\spc{X}$ is isometric to the unit interval $[0,1]$.

\parit{\ref{SHORT.ex:tripod+square:tripod}.}
Let $f$ be an extremal function.
By \ref{lem:opposite-compact}, at least two of the numbers $f(a)+f(b)$, $f(b)+f(c)$, and $f(c)+f(a)$ are $1$.
It follows that for some $x\in[0,\tfrac12]$, we have 
\begin{align*}
f(a)&=1\pm x,&
f(b)&=1\pm x,&
f(c)&=1\pm x,
\end{align*}
where we have one ``minus'' and two ``pluses'' in these three formulas.

Suppose that
\begin{align*}
g(a)&=1\pm y,& g(b)&=1\pm y,& g(c)&=1\pm y
\end{align*}
is another extremal function.
Then $|f-g|\z=|x-y|$ if $g$ has ``minus'' at the same place as $f$ and $|f-g|=|x+y|$ otherwise.

It follows that $\Inj\spc{X}$ is isometric to a {}\emph{tripod} --- three segments of length $\tfrac12$ glued at one end.

\begin{wrapfigure}{r}{27 mm}
\vskip-0mm
\centering
\includegraphics{mppics/pic-3}
\bigskip
\includegraphics{mppics/pic-4}
\end{wrapfigure}

\parit{\ref{SHORT.ex:tripod+square:square}.}
Assume $f$ is an extremal function.
Use \ref{lem:opposite-compact} to show that
\[f(x)+f(y)=f(p)+f(q)=2;\]
in particular, two values $a=f(x)-1$ and $b\z=f(p)-1$ completely describe the function $f$.
Since $f$ is extremal, we also have that 
\[(1\pm a)+(1\pm b)\ge 1\]
for all 4 choices of signs;
equivalently, 
\[|a|+|b|\le 1.\]

It follows that $\Inj\spc{X}$ is isometric to the rhombus $|a|+|b|\le 1$ in the $(a,b)$-plane with the metric induced by the $\ell^\infty$-norm.

\parit{Remarks.}
If $\spc{X}$ has $n$-points, then (evidently) $\Inj\spc{X}$ is a polyhedral complex in $(\RR^n,\ell^\infty) =\ell^\infty(\spc{X})$;
each face of the complex is defined by equalities and inequalities of the following type: $x_i+x_j\ge \const$ and  $x_i+x_j= \const$.
It is easy to see (and follows from \ref{ex:Rm-ell-infty}) that each face is isometric to a convex polyhedron in  $(\RR^k,\ell^\infty)$ for some $k\le n$;
in fact $k\le n/2$.
The structure of the complex can be encoded by certain graphs with the vertex set $\spc{X}$ \cite[see Section 4 in][]{lang-2013}.

\parbf{\ref{ex:kur-inj}.}
Recall that $x\mapsto \distfun_x$ gives an isometric embedding $\spc{X}\z\hookrightarrow\ell^\infty(\spc{X})$;
so we can identify $\spc{X}$ with a subset of $\ell^\infty(\spc{X})$.
Further, $\Inj\spc{X}$ is a subset of $\ell^\infty(\spc{X})$.
It is sufficient to show that $\Inj\spc{X}=G$.

Use \ref{lem:opposite-compact} to show that $\Inj\spc{X}\subset G$.

Given $g\in G$, show that $g(x)=\dist{g}{x}{\ell^\infty(\spc{X})}$.
Conclude that $g$ is admissible and apply \ref{lem:opposite-compact}.

\parit{Source:} The problem has been by Rostislav Matveyev.

\parbf{\ref{ex:4-on-a-line}.}
Recall that 
\[\dist{f}{g}{\Inj\spc{X}}=\sup\set{|f(x)-g(x)|}{x\in\spc{X}}\]
and 
\[\dist{f}{p}{\Inj\spc{X}}=f(p)\]
for any $f,g\in \Inj\spc{X}$ and $p\in \spc{X}$.

Since $\spc{X}$ is compact we can find a point $p\in\spc{X}$ such that 
\[\dist{f}{g}{\Inj\spc{X}}=|f(p)-g(p)|=\left|\dist{f}{p}{\Inj\spc{X}}-\dist{g}{p}{\Inj\spc{X}}\right|.\]
Without loss of generality, we may assume that 
\[\dist{f}{p}{\Inj\spc{X}}
=
\dist{g}{p}{\Inj\spc{X}}
+
\dist{f}{g}{\Inj\spc{X}}.\]
Applying \ref{lem:opposite-compact}, we can find a point $q\in\spc{X}$ such that 
\[\dist{q}{p}{\Inj\spc{X}}
=
\dist{f}{p}{\Inj\spc{X}}
+
\dist{f}{q}{\Inj\spc{X}},\]
whence the result.

Since $\Inj\spc{X}$ is injective (\ref{prop:InjX-is-injective}), by \ref{ex:inj=complete-geodesic-contractible:geodesic} it has to be geodesic. It remains to note that the concatenation of geodesics $[pq]$, $[gf]$, and $[fq]$ is a required geodesic $[pq]$.

\parbf{\ref{ex:delta-hyp}.} The only-if part follows since $\spc{X}$ is isometric to a subset of $\Inj\spc{X}$.

The if part means that 
\[\dist{f}{g}{}+\dist{v}{w}{}\le
\max\{\,\dist{f}{v}{}+\dist{g}{w}{},
\,
\dist{f}{w}{}+\dist{g}{v}{}\,\}+2\cdot\delta\eqlbl{eq:fgvw-hyp}\]
for any $f,g,v,w\in \Inj\spc{X}$.

Suppose $\spc{X}$ is compact. 
Applying \ref{ex:4-on-a-line}, we can choose $p,q,x,y\in \spc{X}$  such that 
\[
\begin{aligned}
\dist{p}{f}{}+\dist{f}{g}{}+\dist{g}{q}{}&=\dist{p}{q}{}
\\
\dist{x}{v}{}+\dist{v}{w}{}+\dist{w}{y}{}&=\dist{x}{y}{}
\end{aligned}
\eqlbl{eq:pfgq+xvwy}
\]

Since $\spc{X}$ is $\delta$-hyperbolic, we have
\[\dist{p}{q}{}+\dist{x}{y}{}\le
\max\{\,\dist{p}{x}{}+\dist{q}{y}{},
\,
\dist{p}{y}{}+\dist{q}{x}{}\,\}+2\cdot\delta.\]
Show that this inequality, together with the triangle inequality and \ref{eq:pfgq+xvwy} imply \ref{eq:fgvw-hyp}.

For the noncompact case, prove an approximate version of \ref{eq:pfgq+xvwy} and apply it the same way.

\parbf{\ref{ex:d-p-inclusion}.}
Show that there is a pair of short maps 
$\Inj\spc{X}\to\Inj\spc{U}\to\Inj\spc{X}$ 
such that their composition is the identity on $\spc{X}$.
Make a conclusion.

\parbf{\ref{ex:ultrametric}.}
Choose three points $x,y,z\in\spc{X}$ and set $\spc{A}=\{x,z\}$.
Let $f\:\spc{A}\z\to \spc{A}$ be the identity map.
Then $F(y)=x$ or $F(y)=z$.
The strong triangle inequality easily follows in both cases.

\parbf{\ref{ex:ultrametric-converse}}; \textit{main part.}
Choose a maximal subset $A\supset K$ that admits a short retraction $f\:A\to K$;
it exists by Zorn's lemma.
If $A$ is the whole space, then the problem is solved.
Otherwise, choose $p\notin A$.

Choose a sequence of points $a_n\in A$ such that $\dist{a_n}{p}{}$ converge to the exact lower bound on the distances from points in $A$ to $p$.
Since $K$ is compact, we can pass to a subsequence of $a_n$ such that $f(a_n)$ converges.
Set $f(p)=\lim f(a_n)$.

It remains to check that 
\[\dist{f(a)}{f(p)}{}\le\dist{a}{p}{}\eqlbl{eq:short-retract}\]
for any $a\in A$.
Choose $\eps>0$; note that 
\[\dist{a_n}{p}{}<\dist{a}{p}{}+\eps
\quad\text{and}\quad
\dist{f(a_n)}{f(p)}{}<\dist{f(a)}{f(a_n)}{}+\eps
\]
for all large~$n$.
Therefore, 
\begin{align*}
\dist{f(a)}{f(p)}{}&\le \max\{\,\dist{f(a)}{f(a_n)}{},\dist{f(a_n)}{f(p)}{}\,\}\le
\\
&\le \dist{f(a)}{f(a_n)}{}+\eps\le
\\
&\le \dist{a}{a_n}{} +\eps\le 
\\
&\le \max\{\,\dist{a}{p}{},\dist{a_n}{p}{}\,\}+\eps< 
\\
&< \dist{a}{p}{}+2\cdot\eps.
\end{align*}
Since $\eps>0$ is arbitrary, we get \ref{eq:short-retract}.

\parit{Example.}
Consider set of $\{\infty,1,2,\dots\}$ with metric defined by 
\[|m-n|=1+\frac1{\min\{m,n\}}\]
for $m\ne n$.
Observe that the space is complete, the subset $\{1,2,\dots\}$ is closed, but it is not a short retract of the ambient space.

\parbf{\ref{ex:petrunin-stadler}.} Consider the space $\spc{Y}^{\spc{X}}$ of all maps $\spc{X}\to \spc{Y}$ equipped with the product topology.

Denote by $\mathfrak{S}_F$ the set of maps $h\in \spc{Y}^\spc{X}$ such that the restriction $h|_F$  is short and agrees with $f$ in $F\cap A$.
Note that the sets $\mathfrak{S}_F\subset \spc{Y}^\spc{X}$ are closed and any finite intersection of these sets is nonempty.

According to Tikhonov's theorem, $\spc{Y}^{\spc{X}}$ is compact.
By the finite intersection property, the intersection $\bigcap_F\mathfrak{S}_F$ for all finite sets $F\subset X$ is nonempty.
Hence the statement follows.

\parit{Source:} \cite{petrunin-stadler}.
