\chapter{Definitions}

In this lecture we give some conventions used further
and remind some the definitions related to metric spaces.
We assume some prior knowledge of basic definitions related to metric spaces.
For a more detailed introduction, we recommend first couple of chapters in the book by Dmitri Burago, Yuri Burago, and Sergei Ivanov \cite{burago-burago-ivanov}.

\section{Metric spaces}
\label{sec:metric spaces}

The distance between two points $x$ and $y$ in a metric space $\spc{X}$ will be denoted by $\dist{x}{y}{}$ or $\dist{x}{y}{\spc{X}}$.
The latter notation is used if we need to emphasize 
that the distance is taken in the space~${\spc{X}}$.

Let us recall the definition of metric. 

\begin{thm}{Definition}\label{def:metric}
A \index{metric}\emph{metric} on a set $\spc{X}$ is a real-valued function $(x,y)\mapsto\dist{x}{y}{\spc{X}}$ that satisfies the following conditions for any three points $x,y,z\in \spc{X}$:

\begin{subthm}{metric>=0}
$\dist{x}{y}{\spc{X}}\ge 0$,
\end{subthm}

\begin{subthm}{metric=0} $\dist{x}{y}{\spc{X}}= 0$ $\iff$ $x=y$,
\end{subthm}

\begin{subthm}{metric:sym} $\dist{x}{y}{\spc{X}}=\dist{y}{x}{\spc{X}}$,
\end{subthm}

\begin{subthm}{metric:triangle} $\dist{x}{y}{\spc{X}}+\dist{y}{z}{\spc{X}}\ge\dist{x}{z}{\spc{X}}$,
\end{subthm}

\end{thm}

Recall that a \index{metric space}\emph{metric space} is a set with a metric on it.
The elements of the set are called \emph{points}. 
Most of the time we keep the same notation for the metric space and its underlying set.

The function 
\[\distfun_x\:y\mapsto \dist{x}{y}{}\]
is called the \index{distance function}\emph{distance function} from~$x$. 

Given $R\in[0,\infty]$ and $x\in \spc{X}$, the sets
\begin{align*}
\oBall(x,R)&=\{y\in \spc{X}\mid \dist{x}{y}{}<R\},
\\
\cBall[x,R]&=\{y\in \spc{X}\mid \dist{x}{y}{}\le R\}
\end{align*}
are called, respectively, the  \index{open ball}\emph{open} and  the \index{closed ball}\emph{closed  balls}   of radius $R$ with center~$x$.
Again, if we need to emphasize that these balls are taken in the metric space $\spc{X}$,
we write 
\[\oBall(x,R)_{\spc{X}}\quad\text{and}\quad\cBall[x,R]_{\spc{X}}.\]

\begin{thm}{Exercise}
Show that
\[\dist{p}{q}{\spc{X}}+\dist{x}{y}{\spc{X}}\le\dist{p}{x}{\spc{X}}+\dist{p}{y}{\spc{X}}+\dist{q}{x}{\spc{X}}+\dist{q}{y}{\spc{X}}\]
for any points $p$, $q$, $x$, and $y$ in a metric space $\spc{X}$.
\end{thm}

\section{Variations of definition}

\parbf{Pseudometris.}
A metric for which the distance between two distinct points can be zero is called a \index{pseudometric}\emph{pseudometric}.
In other words, to define pseudometric, we need to remove condition (\ref{metric=0}) from \ref{def:metric}.

The following observation shows that
nearly any question about pseudometric spaces can be reduced to a question about genuine metric spaces.

Assume $\spc{X}$ is a pseudometric space.
Consider an equivalence relation $\sim$ on $\spc{X}$ defined by
$x\sim y$ if and only if $\dist{x}{y}{}=0$. 
Note that if $x\sim x'$, then $\dist{y}{x}{}=\dist{y}{x'}{}$ for any $y\in\spc{X}$.
Thus, $\dist{*}{*}{}$ defines a metric on the
quotient set $\spc{X}/{\sim}$.
This way we obtain a metric space $\spc{X}'$.
The space $\spc{X}'$ is called the 
\emph{corresponding metric space} for the pseudometric space $\spc{X}$.
Often we do not distinguish between $\spc{X}'$ and~$\spc{X}$. 

\parbf{$\bm{\infty}$-metrics.}
One may also consider metrics with values in $\RR\cup\{\infty\}$;
we might call them \index{metric!$\infty$-metric}\emph{$\infty$-metrics}, but most of the time we use the term {}\emph{metric}.

Again nearly any question about $\infty$-metric spaces can be reduced to a question about genuine metric spaces. 

Indeed, let us write $x\approx y$ if  $\dist{x}{y}{}<\infty$;
this is another equivalence relation on $\spc{X}$.
The equivalence class of a point $x\in\spc{X}$ will be called the \index{metric component}\emph{metric component} 
 of $x$; it will be denoted by $\spc{X}_x$.
One could think of $\spc{X}_x$ as  $\oBall(x,\infty)_{\spc{X}}$ --- the open ball centered at $x$ and radius $\infty$ in $\spc{X}$.

It follows that any $\infty$-metric space is a {}\emph{disjoint union} of genuine metric spaces --- the metric components of the original $\infty$-metric space.

\begin{thm}{Exercise}
Given two sets $A$ and $B$ on the plane, set 
\[\dist{A}{B}{}=\mu(A\backslash B)+\mu(B\backslash A),\]
where $\mu$ denotes the Lebesgue measure.
\begin{subthm}{}
Show that $\dist{*}{*}{}$ is a pseudometric on the set of bounded measurable sets of the plane.
\end{subthm}

\begin{subthm}{}
Show that $\dist{*}{*}{}$ is an $\infty$-metric on the set of all open sets of the plane.
\end{subthm}
\end{thm}

\section{Completeness}

A metric space $\spc{X}$ is called \index{complete space}\emph{complete} if every Cauchy sequence of points in $\spc{X}$ converges in $\spc{X}$.

\begin{thm}{Exercise}\label{ex:almost-min}
Suppose that $\rho$ is a positive continuous function on a complete metric space $\spc{X}$.
Show that for any $\eps>0$ there is a point $x\in \spc{X}$ such that 
\[\rho(x)<(1+\eps)\cdot\rho(y)\]
for any point $y\in \oBall(x,\rho(x))$.
\end{thm}

Most of the time we will assume that a metric space is complete.
The following construction produces a complete metric space $\bar{\spc{X}}$ for any given metric space $\spc{X}$.


\parbf{Completion.}
Given a metric space $\spc{X}$, 
consider the set $\spc{C}$ of all Cauchy sequences in $\spc{X}$.
Note that for any two Cauchy sequences $(x_n)$ and $(y_n)$ the right hand side in \ref{eq:cauchy-dist} is defined; moreover it defines a pseudometric on~$\spc{C}$
\[\dist{(x_n)}{(y_n)}{\spc{C}}\df\lim_{n\to\infty}\dist{x_n}{y_n}{\spc{X}}.\eqlbl{eq:cauchy-dist}\]
The corresponding metric space $\bar{\spc{X}}$ is called a \index{completion}\emph{completion} of $\spc{X}$.

Note that the original space $\spc{X}$ forms a dense subset in its completion $\bar{\spc{X}}$.
More precisely,  for each point $x\in\spc{X}$ one can consider a constant sequence $x_n=x$ which is Cauchy.
It defines a natural map $\spc{X}\to \bar{\spc{X}}$.
It is easy to check that this map is distance-preserving.
In particular we can (and will) consider $\spc{X}$ as a subset of $\bar{\spc{X}}$.

\begin{thm}{Exercise}
Show that completion of a metric space is complete.
\end{thm}


\section{Compact spaces}

Let us recall few equivalent definitions of compact metric spaces.

\begin{thm}{Definition}\label{def:compact}
A metric space $\spc{K}$ is compact if and only if one of the following equivalent condition holds:

\begin{subthm}{}
 Every open cover of $\spc{K}$ has a finite subcover.
\end{subthm}

\begin{subthm}{}
 For any open cover of $\spc{K}$ there is $\eps>0$ such that any $\eps$-ball in $\spc{K}$ lie in one element of the cover. (The value $\eps$ is called a \index{Lebesgue number}\emph{Lebesgue number} of the covering.)
\end{subthm}

\begin{subthm}{}
 Every sequence of points in $\spc{K}$ has a subsequence that converges in $\spc{K}$.
\end{subthm}

\begin{subthm}{totally-bounded}
The space $\spc{K}$ is complete and \index{totally bounded space}\emph{totally bounded}; that is, for any $\eps>0$, the space $\spc{K}$ admits a finite cover by open $\eps$-balls.
\end{subthm}

\end{thm}

A subset $N$ of a metric space $\spc{K}$ is called \index{net}\emph{$\eps$-net} if any point $x\in \spc{K}$ lies on the distance less than $\eps$ from a point in $N$.
Note that totally bounded spaces can be defined as spaces that admit a finite $\eps$-net for any $\eps>0$.

\begin{thm}{Exercise}\label{ex:compact-net}
Show that a space $\spc{K}$ is totally bounded if and only if it contains a compact $\eps$-net for any $\eps>0$. 
\end{thm}


Let $\pack_\eps\spc{X}$ be exact upper bound on the number of points $x_1,\z\dots,x_n\in \spc{X}$ such that $\dist{x_i}{x_j}{}\ge\eps$ if $i\ne j$.

If $n=\pack_\eps\spc{X}<\infty$, then
the collection of points $x_1,\dots,x_n$ is called a \index{maximal packing}\emph{maximal $\eps$-packing}.
Note that $n$ is the maximal number of open disjoint $\tfrac\eps2$-balls in $\spc{X}$.

\begin{thm}{Exercise}\label{ex:pack-net}
Show that a complete space $\spc{X}$ is compact if and only of $\pack_\eps\spc{X}\z<\infty$ for any $\eps>0$.

Show that any maximal $\eps$-packing is an $\eps$-net.
\end{thm}


\begin{thm}{Exercise}\label{ex:non-contracting-map}
Let $\spc{K}$  be a compact metric space and
\[f\:\spc{K}\z\to \spc{K}\] 
be a distance-nondecreasing map.
Prove that $f$ is an \index{isometry}\emph{isometry};
that is, $f$ is a distance-preserving bijection.
\end{thm}

A metric space $\spc{X}$ is called \index{locally compact space}\emph{locally compact} if any point in $\spc{X}$ admits a compact neighborhood;
in other words, for any point $x\in\spc{X}$ a closed ball $\cBall[x,r]$ is compact for some $r>0$.

\section{Proper spaces}

A metric space $\spc{X}$ is called \index{proper space}\emph{proper} if all closed bounded sets in $\spc{X}$ are compact. 
This condition is equivalent to each of the following statements:
\begin{itemize}
\item For some (and therefore any) point $p\in \spc{X}$ and any $R<\infty$, 
the closed ball $\cBall[p,R]_{\spc{X}}$ is compact. 
\item The function $\distfun_p\:\spc{X}\to\RR$ is \index{proper function}\emph{proper} for some (and therefore any) point $p\in \spc{X}$;
that is, for any compact set $K\subset \RR$, its inverse image 
\[\distfun_p^{-1}(K)=\set{x\in \spc{X}}{\dist{p}{x}{\spc{X}}\in K}\]
is compact.
\end{itemize}

\begin{thm}{Exercise}\label{ex:loc-compact-not-proper}
Give an example of space which is locally compact but not proper.
\end{thm}

\section{Geodesics}
\label{sec:geods}

Let $\spc{X}$ be a metric space 
and $\II$\index{$\II$} a real interval. 
A~globally isometric map $\gamma\:\II\to \spc{X}$ is called a \index{geodesic}\emph{geodesic}%
\footnote{Various authors call it differently: {}\emph{shortest path}, {}\emph{minimizing geodesic}.
Also note that the meaning of the term \emph{geodesic} is different from what is used in Riemannian geometry, altho they are closely related.}; 
in other words, $\gamma\:\II\to \spc{X}$ is a geodesic if 
\[\dist{\gamma(s)}{\gamma(t)}{\spc{X}}=|s-t|\]
for any pair $s,t\in \II$.

If $\gamma\:[a,b]\to \spc{X}$ is a geodesic and $p=\gamma(a)$, $q=\gamma(b)$, then we say that $\gamma$ is a geodesic from point $p$ to point $q$.
In this case the image of $\gamma$ is denoted by $[p q]$\index{$[{*}{*}]$} and with an abuse of notations  we also call it a \index{geodesic}\emph{geodesic}.
We may write $[p q]_{\spc{X}}$ 
to emphasize that the geodesic $[p q]$ is in the space  ${\spc{X}}$.

In general, a geodesic from $p$ to $q$ need not exist and if it exists, it need not  be unique.  
However, once we write $[p q]$ we assume mean that we have made a choice of geodesic.

A \index{geodesic path}\emph{geodesic path} is a geodesic with constant-speed parameterization by the unit interval $[0,1]$.

A curve $\gamma\:\II\to \spc{X}$  is called a \index{geodesic!local geodesic}\emph{local geodesic} if for any $t\in\II$ there is a neighborhood $U$ of $t$ in $\II$ such that the restriction $\gamma|_U$ is a  geodesic.
A constant-speed parameterization of a local geodesic by the unit interval $[0,1]$ is called a \index{geodesic!local geodesic}\emph{local geodesic path}. 

\section{Geodesic spaces and metric trees}

A metric space is called \index{geodesic}\emph{geodesic} if any pair of its points can be joined by a geodesic.

\begin{thm}{Exercise}\label{ex:pogorelov}
Let $f$ be a centrally symmetric positive continuous function on $\mathbb{S}^2$.
Given two points $x,y\in \mathbb{S}^2$,
set 
\[\|x-y\|=\int_{B(x,\frac \pi2)\backslash B(y,\frac\pi2)}f.\]

Show that $(\mathbb{S}^2,\|{*}-{*}\|)$ is a geodesic space
and moreover, the geodesics in $(\mathbb{S}^2,\|{*}-{*}\|)$ run along great circles of $\mathbb{S}^2$.
\end{thm}

A geodesic space $\spc{T}$ is called a \index{metric tree}\emph{metric tree} if any pair of points in $\spc{T}$ are connected by a unique geodesic,
and the union of any two geodesics $[xy]_{\spc{T}}$, and $[yz]_{\spc{T}}$ contain the geodesic $[xz]_{\spc{T}}$.
In other words any triangle in $\spc{T}$ is a tripod;
that is, for any three geodesics $[xy]$, $[yz]$, and $[zx]$ have a common point.

Recall that the set 
\[S_r(p)=\set{x\in\spc{X}}{\dist{p}{x}{\spc{X}}=r}\]
is called \emph{sphere} with center $p$ and radius $r$ in a metric space $\spc{X}$.

\begin{thm}{Exercise}
Show that spheres in metric trees are ultrametric spaces.
That is, 
\[\dist{x}{z}{\spc{T}}
\le
\max\{\,\dist{x}{y}{\spc{T}},\dist{y}{z}{\spc{T}}\,\}\]
for any $x,y,z\in S_r(p)_{\spc{T}}$.
\end{thm}


\section{Length}

A \index{curve}\emph{curve} is defined as a continuous map from a real interval $\II$ to a metric space.
If $\II=[0,1]$, that is if the interval is unit, then the curve is called a \index{path}\emph{path}.

\begin{thm}{Definition}
Let $\spc{X}$ be a metric space and
$\alpha\: \II\to \spc{X}$ be a curve.
We define the \index{length}\emph{length} of $\alpha$ as 
\[
\length \alpha \df \sup_{t_0\le t_1\le\ldots\le t_n}\sum_i \dist{\alpha(t_i)}{\alpha(t_{i-1})}{}.
\]

A curve $\alpha$ is called \index{rectifiable curve}\emph{rectifiable} if $\length \alpha<\infty$.
\end{thm}



\begin{thm}{Theorem}\label{thm:length-semicont}
Length is a lower semi-continuous with respect to pointwise convergence of curves. 

More precisely, assume that a sequence
of curves $\gamma_n\:\II\to \spc{X}$ in a metric space $\spc{X}$ converges pointwise 
to a curve $\gamma_\infty\:\II\to \spc{X}$;
that is, for any fixed $t \in \II$, $\gamma_n(t)\z\to\gamma_\infty(t)$ as $n\to\infty$. 
Then 
$$\liminf_{n\to\infty} \length\gamma_n \ge \length\gamma_\infty.\eqlbl{eq:semicont-length}$$
\end{thm}


\begin{wrapfigure}{o}{20 mm}
\vskip-0mm
\centering
\includegraphics{mppics/pic-100}
\end{wrapfigure}


Note that the inequality \ref{eq:semicont-length} might be strict.
For example the diagonal $\gamma_\infty$ of the unit square 
can be  approximated by a stairs-like
polygonal curves $\gamma_n$
with sides parallel to the sides of the square ($\gamma_6$ is on the picture).
In this case
\[\length\gamma_\infty=\sqrt{2}\quad
\text{and}\quad \length\gamma_n=2\]
for any $n$.

\parit{Proof.}
Fix a sequence $t_0\le t_1\le\dots\le t_k$ in $\II$.
Set 
\begin{align*}\Sigma_n
&\df
|\gamma_n(t_0)-\gamma_n(t_1)|+\dots+|\gamma_n(t_{k-1})-\gamma_n(t_k)|.
\\
\Sigma_\infty
&\df
|\gamma_\infty(t_0)-\gamma_\infty(t_1)|+\dots+|\gamma_\infty(t_{k-1})-\gamma_\infty(t_k)|.
\end{align*}

Note that for each $i$ we have 
\[|\gamma_n(t_{i-1})-\gamma_n(t_i)|\to|\gamma_\infty(t_{i-1})-\gamma_\infty(t_i)|\]
and therefore
\[\Sigma_n\to \Sigma_\infty\] 
as $n\to\infty$.
Note that 
\[\Sigma_n\le\length\gamma_n\]
for each $n$.
Hence
$$\liminf_{n\to\infty} \length\gamma_n \ge \Sigma_\infty.\eqlbl{>=Sigma-infty}$$

If $\gamma_\infty$ is rectifiable, we can assume that 
\begin{align*}
\length\gamma_\infty<\Sigma_\infty+\eps.
\end{align*}
for any given $\eps>0$.
By \ref{>=Sigma-infty} it follows that 
$$\liminf_{n\to\infty} \length\gamma_n > \length\gamma_\infty-\eps$$
for any $\eps>0$; whence \ref{eq:semicont-length} follows.

It remains to consider the case when $\gamma_\infty$ is not rectifiable; 
that is, $\length\gamma_\infty=\infty$.
In this case we can choose a partition so that $\Sigma_\infty>L$ for any real number $L$.
By \ref{>=Sigma-infty} it follows that 
$$\liminf_{n\to\infty} \length\gamma_n > L$$
for any given $L$; whence 
\[\liminf_{n\to\infty}\length\gamma_n=\infty\]
and \ref{eq:semicont-length} follows.
\qeds

\section{Length spaces}\label{sec:intrinsic}

If for any $\eps>0$ and any pair of points $x$ and $y$ in a metric space $\spc{X}$, there is a path $\alpha$ connecting $x$ to $y$ such that
\[\length\alpha< \dist{x}{y}{}+\eps,\]
then $\spc{X}$ is called a \index{length space}\emph{length space} and the metric on $\spc{X}$ is called a \index{length metric}\emph{length metric}.\label{page:length metric}

If $\spc{X}$ is an $\infty$-metric space, then in the above definition we assume in addition that $x$ and $y$ lie in one metric component; that is, $\dist{x}{y}{\spc{X}}<\infty$.
In other words an $\infty$-metric space $\spc{X}$ is a length space if each metric component of $\spc{X}$ is a length space.

Note that any geodesic space is a length space.
The following example shows that the converse does not hold.


\begin{thm}{Example}
Suppose a space $\spc{X}$ is obtained by gluing a countable collection of disjoint intervals $\{\II_n\}$ of length $1+\tfrac1n$, where for each $\II_n$ the left end is glued to $p$ and the right end to~$q$.

Observe that the space $\spc{X}$ carries a natural complete length metric with respect to which $\dist{p}{q}{\spc{X}}=1$ but there is no geodesic connecting $p$ to~$q$.
\end{thm}

\begin{thm}{Exercise}\label{ex:no-geod}
Give an example of a complete length space $\spc{X}$ such that no pair of distinct points in $\spc{X}$ can be joined by a geodesic.
\end{thm}

Directly from the definition, it follows that if a path $\alpha\:[0,1]\to\spc{X}$ connects two points $x$ and $y$ 
(that is, if $\alpha(0)=x$ and $\alpha(1)=y$), then 
\[\length\alpha\ge \dist{x}{y}{}.\]
Set 
\[\yetdist{x}{y}{}=\inf\{\length\alpha\}\]
where the greatest lower bound is taken for all paths connecting $x$ and~$y$.
It is straightforward to check that $(x,y)\mapsto \yetdist{x}{y}{}$ is an $\infty$-metric; moreover $(\spc{X},\yetdist{*}{*}{})$ is a length space.
The metric $\yetdist{*}{*}{}$ is called \index{induced length metric}\emph{induced length metric}.

\begin{thm}{Exercise}\label{ex:compact+connceted}
Let $\spc{X}$ be a complete length space.
Show that for any compact subset $K$ in $\spc{X}$
there is a compact path connected subset $K'$ that contains $K$.  
\end{thm}

\begin{thm}{Exercise}\label{ex:compact=>complete}
Suppose $(\spc{X},\dist{*}{*}{})$ is a complete metric space.
Show that $(\spc{X},\yetdist{*}{*}{})$ is complete.
\end{thm}

Let $A$ be a subset of a metric space $\spc{X}$.
Given two points $x,y\in A$,
consider the value
\[\dist{x}{y}{A}=\inf_{\alpha}\{\length\alpha\},\]
where the greatest lower bound is taken for all paths $\alpha$ from $x$ to $y$ in~$A$.
In other words $\dist{*}{*}{A}$ denotes the induced length metric on the subspace $A$.%
\footnote{The notation $\dist{*}{*}{A}$ conflicts with the previously defined notation for distance $\dist{x}{y}{\spc{X}}$ in a metric space $\spc{X}$. However, most of the time we will work with ambient length spaces where the meaning will be unambiguous.}

Let $\spc{X}$ be a metric space and $x,y\in\spc{X}$.

\begin{enumerate}[(i)]
\item A point $z\in \spc{X}$ is called a \index{midpoint}\emph{midpoint} between $x$ and $y$
if 
\[\dist{x}{z}{}=\dist{y}{z}{}=\tfrac12\cdot\dist[{{}}]{x}{y}{}.\]
\item Assume $\eps\ge 0$.
A point $z\in \spc{X}$ is called an \index{$\eps$-midpoint}\emph{$\eps$-midpoint} between $x$ and $y$
if 
\[\dist{x}{z}{},\quad\dist{y}{z}{}\le\tfrac12\cdot\dist[{{}}]{x}{y}{}+\eps.\]
\end{enumerate}


Note that a $0$-midpoint is the same as a midpoint.


\begin{thm}{Lemma}\label{lem:mid>geod}
Let $\spc{X}$ be a complete metric space.
\begin{subthm}{lem:mid>length}
Assume that for any pair of points $x,y\in \spc{X}$  
 and any $\eps>0$
there is an $\eps$-midpoint~$z$.
Then $\spc{X}$ is a length space.
\end{subthm}

\begin{subthm}{lem:mid>geod:geod}
Assume that for any pair of points $x,y\in \spc{X}$, 
there is a midpoint~$z$.
Then $\spc{X}$ is a geodesic space.
\end{subthm}
\end{thm}

\parit{Proof.}
We first prove \ref{SHORT.lem:mid>length}.
Let $x,y\in \spc{X}$ be a pair of points.

Set $\eps_n=\frac\eps{4^n}$, $\alpha(0)=x$ and $\alpha(1)=y$.

Let $\alpha(\tfrac12)$ be an $\eps_1$-midpoint between $\alpha(0)$ and $\alpha(1)$.
Further, let $\alpha(\frac14)$ 
and $\alpha(\frac34)$ be $\eps_2$-midpoints between the pairs $(\alpha(0),\alpha(\tfrac12))$ 
and $(\alpha(\tfrac12),\alpha(1))$ respectively.
Applying the above procedure recursively,
on the $n$-th step we define $\alpha(\tfrac{k}{2^n})$,
for every odd integer $k$ such that $0<\tfrac k{2^n}<1$, 
as an $\eps_{n}$-midpoint between the already defined
$\alpha(\tfrac{k-1}{2^n})$ and $\alpha(\tfrac{k+1}{2^n})$.


In this way we define $\alpha(t)$ for $t\in W$,
where $W$ denotes the set of dyadic rationals in $[0,1]$.
Since $\spc{X}$ is complete, the map $\alpha$ can be extended continuously to $[0,1]$.
Moreover,
\[\begin{aligned}
\length\alpha&\le \dist{x}{y}{}+\sum_{n=1}^\infty 2^{n-1}\cdot\eps_n\le
\\
&\le \dist{x}{y}{}+\tfrac\eps2.
\end{aligned}
\eqlbl{eq:eps-midpoint}
\]
Since $\eps>0$ is arbitrary, we get \ref{SHORT.lem:mid>length}.

To prove \ref{SHORT.lem:mid>geod:geod}, 
one should repeat the same argument 
taking midpoints instead of $\eps_n$-midpoints.
In this case \ref{eq:eps-midpoint} holds for $\eps_n=\eps=0$.
\qeds

Since in a compact space a sequence of $\tfrac1n$-midpoints $z_n$ contains a convergent subsequence, Lemma~\ref{lem:mid>geod} immediately implies

\begin{thm}{Proposition}\label{prop:length+proper=>geodesic}
Any proper length space is geodesic.
\end{thm}

\begin{thm}{Hopf--Rinow theorem}\label{thm:Hopf-Rinow}
Any complete, locally compact length space is proper.
\end{thm}

Before reading the proof, it is instructive to solve \ref{ex:loc-compact-not-proper}.

\parit{Proof.}
Let $\spc{X}$ be a locally compact length space.
Given $x\in \spc{X}$, denote by $\rho(x)$ the least upper bound of all $R>0$ such that
the closed ball $\cBall[x,R]$ is compact.
Since $\spc{X}$ is locally compact, 
$$\rho(x)>0
\quad\text{for any}\quad
x\in \spc{X}.\eqlbl{eq:rho>0}$$
It is sufficient to show that $\rho(x)=\infty$ for some (and therefore any) point $x\in \spc{X}$.

\begin{clm}{} If $\rho(x)<\infty$, then $B=\cBall[x,\rho(x)]$ is compact.
\end{clm}

Indeed, $\spc{X}$ is a length space;
therefore for any $\eps>0$, 
the set $\cBall[x,\rho(x)-\eps]$ is a compact $\eps$-net in~$B$.
Since $B$ is closed and hence complete, it must be compact.
\claimqeds
Next we claim that
\begin{clm}{} $|\rho(x)-\rho(y)|\le \dist{x}{y}{\spc{X}}$ for any $x,y\in \spc{X}$;
in particular $\rho\:\spc{X}\to\RR$ is a continuous function.
\end{clm}

Indeed, 
assume the contrary; that is, $\rho(x)+|x-y|<\rho(y)$ for some $x,y\in \spc{X}$. 
Then 
$\cBall[x,\rho(x)+\eps]$ is a closed subset of $\cBall[y,\rho(y)]$ for some $\eps>0$.
Then  compactness of $\cBall[y,\rho(y)]$ implies compactness of $\cBall[x,\rho(x)+\eps]$, a contradiction.\claimqeds

Set $\eps=\min\set{\rho(y)}{y\in B}$; the minimum is defined since $B$ is compact and $\rho$ is continuous.
From \ref{eq:rho>0}, we have $\eps>0$.

Choose a finite $\tfrac\eps{10}$-net $\{a_1,a_2,\dots,a_n\}$ in $B=\cBall[x,\rho(x)]$.
The union $W$ of the closed balls $\cBall[a_i,\eps]$ is compact.
Clearly 
$\cBall[x,\rho(x)+\frac\eps{10}]\subset W$.
Therefore $\cBall[x,\rho(x)+\frac\eps{10}]$ is compact,
a contradiction.
\qeds

\begin{thm}{Exercise}\label{exercise from BH}
Construct a geodesic space $\spc{X}$ that is locally compact,
but whose completion $\bar{\spc{X}}$ is neither geodesic nor locally compact.
\end{thm}


\begin{thm}{Advanced exercise}\label{ex:gross}
Show that for any compact length-metric space $\spc{X}$ there is number $\ell$ such that for any finite collection of points there is a point $z$ that lies of average distance $\ell$ from the collection;
that is, for any $x_1,\dots,x_n\in \spc{X}$ there is $z\in \spc{X}$ such that
\[\tfrac1n\cdot\sum_i|x_i-z|_{\spc{X}}=\ell.\]
\end{thm}


Recall that \index{Borel measure}\emph{Borel measure} is a measure on a metric space that is defined on all open sets (and thus on all Borel sets).
The space of Borel probability measures on a metric space $\spc{X}$ can be equipped with the following metric 
\[\dist{\mu}{\nu}{}\df\sup\left\{\,\int_{\spc{X}} f\cdot(\mu-\nu)\,\right\},\]
where the least upper bound is taken for all $1$-Lipschitz functions $f\:\spc{X}\to\RR$.
The obtained metric space is called \index{Wasserstein space}\emph{Wasserstein space} of order 1 over $\spc{X}$ and denoted by $\Wass_1\spc{X}$.

\begin{thm}{Exercise}
Let $\spc{X}$ be a compact metric space.
Show that $\Wass_1\spc{X}$ is a compact length metric space.
\end{thm}





